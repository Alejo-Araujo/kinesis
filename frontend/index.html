<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon" sizes="180x180" href="/public/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/public/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/public/favicon-16x16.png">
    <link rel="manifest" href="/public/site.webmanifest">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

     <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script> 


    <link rel="stylesheet" href="styles.css">
    <script type="module" src="./js/main.js"></script>
    
    <title>Centro Kinesis</title>
</head>
<body>

<!-- DIV DE CARGA -->
<div id="initial-loading-overlay" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #fff; /* O tu color de fondo preferido para la carga */
        z-index: 99999; /* Asegura que esté por encima de casi todo */
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        font-family: Arial, sans-serif;
        font-size: 1.2em;
        color: #555;
        opacity: 1; /* Asegura que sea visible al principio */
        transition: opacity 0.5s ease-out; /* Para que se desvanezca suavemente */
    ">
        <!-- <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
            <span class="visually-hidden">Cargando...</span>
        </div>
        <p class="mt-3">Cargando aplicación...</p> -->

        <img src="/public/apple-touch-icon.png" alt="Cargando..." class="loading-image"> 
        <p class="mt-3">Cargando aplicación...</p>
</div>

<!-- DIV MENSAJES -->
<div id="messageContainer" class="fixed-top container mt-3" style="z-index: 1050;"></div>

<!-- MODAL CONFIRMACION -->
<div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white"> <h5 class="modal-title" id="confirmModalLabel">Confirmar Operación</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                ¿Está seguro que desea realizar esta acción?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="btnConfirmAction">Confirmar</button>
            </div>
        </div>
    </div>
</div>

<!-- DIV LOGIN -->
<div id="divLogin" class="container content-section d-none my-5">
    <div class="card p-4 mx-auto" style="max-width: 500px;"> <div class="text-center mb-4"> <img src="./assets/centroKinesis.png" alt="Centro Kinesis Logo" width="320.45" height="250" class="img-fluid">
        </div>
        <h2 class="mb-3 text-center">Iniciar Sesión</h2>
        <form id="loginForm"> <div class="mb-3">
                <label for="loginCedula" class="form-label">Cédula:</label>
                <input type="text" class="form-control" id="loginCedula" required>
            </div>
            <div class="mb-3">
                <label for="loginPassword" class="form-label">Contraseña:</label>
                <div class="input-group">
                    <input type="password" class="form-control" id="loginPassword" required>
                    <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                        <i class="bi bi-eye"></i> </button>
                </div>
            </div>
            <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="rememberMe">
                <label class="form-check-label" for="rememberMe">Mantenerme conectado</label>
            </div>
            <button type="submit" class="btn btn-primary w-100">Entrar</button>
            <div id="divLoginError" class="alert alert-danger mt-3 d-none"></div>
        </form>
    </div>
</div>
  
<!-- DIV PRINCIPAL -->
<div id="divPrincipal" >

<!-- BARRA DE NAVEGACION -->
<nav id ="navbar" class="navbar navbar-expand-md navbar-light fixed-top d-none " >
  <div class="container-fluid">
    
    <a class="navbar-brand" href="#">
    <img src="./assets/ruedaKinesis.png" alt="" width="130" height="60" class="d-inline-block align-text-top img-fluid">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"> 
      
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Agenda
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#" data-target="divAgenda">Agenda Clínica</a></li>
            <li><a class="dropdown-item" href="#" data-target="divAgendaPersonal">Agenda Personal</a></li>
          </ul>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="#" data-target="divPaciente">Pacientes</a>
        </li>
          <li id="liFichaMedica" class="nav-item" hidden>
          <a class="nav-link" href="#" data-target="divFichaMedica">Historia Clínica</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" data-target="divNombreDiagnostico">Diagnosticos</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Facturación
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#" data-target="divCuotas">Mensual</a></li>
            <!-- <li><a class="dropdown-item" href="#" data-target="divFacturacionSesiones">Por sesiones</a></li> -->
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>


<!-- DIV AGENDA -->
<div id="divAgenda" class="container agenda-table d-none">
    <h2 class="mb-4">Agenda Semanal</h2>
    <div class="table-responsive">
        <div id="tableLoadingOverlayAgenda" class="loading-overlay" style="display: none;">
            <img src="/public/apple-touch-icon.png" alt="Cargando..." class="loading-image"> 
        <p class="mt-2 text-primary">Cargando Agenda...</p>
    </div>
    <table id="tablaAgendaSemanal" class="table table-bordered">
      <thead>
        <tr>
          <th>Horario</th>
          <th>Lunes</th>
          <th>Martes</th>
          <th>Miércoles</th>
          <th>Jueves</th>
          <th>Viernes</th>
          <th>Sábado</th>
          <th>Domingo</th>
        </tr>
      </thead>
        <tbody>
        </tbody>
    </table>
    </div>
    <div class="mt-3">
        <button id="btnAgregarHorario" class="btn btn-info me-2" data-bs-toggle="modal" data-bs-target="#addHorarioModal">Agregar Horario</button>
        <button id="btnFijarseHorario" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#fijarseHorarioModal">Fijarse Horarios de paciente</button>
    </div>
</div> 


<!-- MODAL FIJARSE HORARIO -->
<div class="modal fade" id="fijarseHorarioModal" tabindex="-1" aria-labelledby="fijarseHorarioModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="fijarseHorarioModalLabel">Fijarse Horario de Paciente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formFijarseHorario">
                    <div class="mb-3">
                        <label for="selectedPacienteNameFijarseHorario" class="form-label">Paciente</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="selectedPacienteNameFijarseHorario" readonly placeholder="Ningún paciente seleccionado">
                                <button class="btn btn-outline-secondary" type="button" id="selectPacienteBtnFijarseHorario" data-bs-toggle="modal" data-bs-target="#selectPacienteFijarseHorarioModal">Seleccionar Paciente</button>
                                <input type="hidden" id="selectedPacienteIdFijarseHorario" disabled>
                            </div>
                    </div>
                </form>
                <div id="tablaHorariosFijarseHorarioContainer" class="table-scroll shadow-sm rounded border mt-4">
                    <div id="tableLoadingOverlayFijarseHorarios" class="loading-overlay" style="display: none;">
                        <img src="/public/apple-touch-icon.png" alt="Cargando..." class="loading-image"> 
                        <p class="mt-2 text-primary">Cargando horarios...</p>
                    </div>
                    <table class="table table-sm table-hover" id="tablaHorariosFijarseHorario">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">Día</th>
                                <th scope="col">Hora Inicio</th>
                                <th scope="col">Hora Fin</th>
                            </tr>
                        </thead>
                        <tbody id="tablaFijarseHorarioBody">
                        </tbody>
                    </table>
                    <div class="d-flex justify-content-between align-items-center p-2 text-muted bg-light border-top">
                        <div class="d-flex align-items-center">
                            Total de horarios: <strong id="contadorHorariosFijarseHorario" class="ms-1">0</strong>
                        </div>
                    </div>
                </div>                
            </div>
            <div class="modal-footer">
                <button type="button" form="formFijarseHorario" class="btn btn-primary" id="btnFijarseHorarioPaciente">Fijarse horarios</button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL AGREGAR PACIENTE A FIJARSE HORARIO -->
<div class="modal fade" id="selectPacienteFijarseHorarioModal" tabindex="-1" aria-labelledby="selectPacienteModalLabelFijarseHorario" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="selectPacienteModalLabelFijarseHorario">Seleccionar Paciente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="filtrosPacienteSeleccionContainerFijarseHorario">
                    <div class="row mb-3 align-items-end">
                        <div class="col-md-4">
                            <label for="selectDiagnosticosBuscarSeleccionFijarseHorario" class="form-label">Filtrar por diagnósticos:</label>
                            <select id="selectDiagnosticosBuscarSeleccionFijarseHorario" class="form-select"></select>
                        </div>
                        <div class="col-md-4">
                            <label for="inputBuscarNombreSeleccionFijarseHorario" class="form-label">Nombre:</label>
                            <input type="text" id="inputBuscarNombreSeleccionFijarseHorario" class="form-control" placeholder="Buscar por nombre">
                        </div>
                        <div class="col-md-4">
                            <label for="inputBuscarCedulaSeleccionFijarseHorario" class="form-label">Cédula:</label>
                            <input type="text" id="inputBuscarCedulaSeleccionFijarseHorario" class="form-control" placeholder="Buscar por cédula">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="selectActiveSeleccionFijarseHorario" class="form-label">Mostrar:</label>
                            <select id="selectActiveSeleccionFijarseHorario" class="form-select"></select>
                        </div>
                    </div>
                </div>

                <div id="divTablaPacientesSeleccionFijarseHorario" class="table-scroll shadow-sm rounded border">
                    <div id="tableLoadingOverlaySeleccionFijarseHorario" class="loading-overlay" style="display: none;">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="mt-2 text-primary">Cargando pacientes...</p>
                    </div>
                    <table class="table table-sm table-hover" id="tablaPacientesSeleccionFijarseHorario">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Nombre y Apellido</th>
                                <th scope="col">Cédula</th>
                                <th scope="col">Diagnósticos</th>
                                <th scope="col">Teléfono</th>
                                <th scope="col">Gmail</th>
                                <th scope="col">Activo</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>

                    <div class="d-flex justify-content-between align-items-center p-2 text-muted bg-light border-top">
                        <div class="d-flex align-items-center">
                            Total de pacientes: <strong id="contadorPacientesSeleccionFijarseHorario" class="ms-1">0</strong>
                        </div>
                        <nav aria-label="Navegación de pacientes">
                            <ul class="pagination mb-0" id="paginationControlsSeleccionFijarseHorario"></ul>
                        </nav>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnSeleccionarPacienteModalFijarseHorario" disabled>Agregar Paciente</button>
            </div>
        </div>
    </div>
</div>


<!-- MODAL AGREGAR HORARIO -->
<div class="modal fade" id="addHorarioModal" tabindex="-1" aria-labelledby="addHorarioModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addHorarioModalLabel">Agregar Nuevo Horario</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formAddHorario">
                    <div class="mb-3">
                        <label for="selectAddDiaHorario" class="form-label">Día de la Semana</label>
                        <select class="form-select" id="selectAddDiaHorario" required>
                            <option value="">Selecciona un día</option>
                            <option value="Lunes">Lunes</option>
                            <option value="Martes">Martes</option>
                            <option value="Miercoles">Miércoles</option>
                            <option value="Jueves">Jueves</option>
                            <option value="Viernes">Viernes</option>
                            <option value="Sabado">Sábado</option>
                        </select>
                        <div class="invalid-feedback">
                            Por favor, selecciona un día.
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="inputAddHoraInicio" class="form-label">Hora de Inicio</label>
                        <input type="time" class="form-control" id="inputAddHoraInicio" required>
                        <div class="invalid-feedback">
                            Por favor, ingresa la hora de inicio.
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="inputAddHoraFin" class="form-label">Hora de Fin</label>
                        <input type="time" class="form-control" id="inputAddHoraFin" required>
                        <div class="invalid-feedback">
                            Por favor, ingresa la hora de fin.
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" form="formAddHorario" class="btn btn-primary" id="btnAddHorario">Guardar Horario</button>
            </div>
        </div>
    </div>
</div>


<!-- AGENDA PERSONAL -->
<div class="container mt-4 d-none" id="divAgendaPersonal">
    <h2>Agenda Personal / Calendario</h2>

    <div id="calendar" class="card p-3 shadow-sm"> 
        <div class="calendar-header d-flex justify-content-between align-items-center mb-3">
            <button id="prevMonthBtn" class="btn btn-outline-secondary">&lt; Mes Anterior</button>
            <h4 id="currentMonthYear" class="mb-0"></h4>
            <button id="nextMonthBtn" class="btn btn-outline-secondary">Mes Siguiente &gt;</button>
        </div>

        <div class="calendar-days-names d-flex text-center mb-2 fw-bold">
            <div class="flex-fill">Lun</div>
            <div class="flex-fill">Mar</div>
            <div class="flex-fill">Mié</div>
            <div class="flex-fill">Jue</div>
            <div class="flex-fill">Vie</div>
            <div class="flex-fill">Sáb</div>
            <div class="flex-fill">Dom</div>
        </div>

        <div id="calendar-grid" class="calendar-grid">
            </div>

        <div id="calendar-loading-overlay" class="loading-overlay">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <p class="mt-2 text-primary">Cargando calendario...</p>
        </div>
    </div>
    <div class="mt-3">
        <button id="btnVerSesionesFisio" class="btn btn-info me-2" data-bs-toggle="modal" data-bs-target="#modalEstadisticasSesiones">Ver sesiones de cada fisioterapeuta</button>
    </div>
</div>


<!-- MODAL SESIONES EN UN DIA -->
 <div class="modal fade" id="sesionDiaModal" tabindex="-1" aria-labelledby="sesionDiaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="sesionDiaModalLabel">Sesiones del día</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p><strong>Día:</strong> <span id="modalDiaSesion"></span></p>
                
                <div class="row mt-3">
                    <div class="col-md-12"> <h6>Sesiones:</h6>
                        <div class="table-responsive shadow-sm rounded border">
                            <table class="table table-sm table-hover" id="modalTablaSesiones">
                                <thead class="table-light">
                                    <tr>
                                        <th>Hora Inicio</th>
                                        <th>Hora Fin</th>
                                        <th>Fisioterapeuta</th>
                                        <th>Paciente</th> </tr>
                                </thead>
                                <tbody id="modalTablaSesionesBody">
                                    </tbody>
                            </table>
                            <div id="noSesionesMensaje" class="p-3 text-center text-muted" style="display: none;">
                                No hay sesiones programadas para este día.
                            </div>
                        </div>
                        
                        <div class="mt-3 d-flex gap-2 justify-content-end"> <button id="btnAgregarSesion" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#sessionDetailModal" >Agregar Sesión</button>
                            <button id="btnModificarSesion" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#sessionDetailModal" disabled>Modificar Sesión</button>
                            <button id="btnEliminarSesion" class="btn btn-danger" disabled>Eliminar Sesión</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL DE AGREGAR SESION -->
<div class="modal fade" id="sessionDetailModal" tabindex="-1" aria-labelledby="sessionDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="sessionDetailModalLabel">Detalle de Sesión / Nueva Sesión</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="sessionForm">
                        <div class="mb-3">
                            <label for="sessionDate" class="form-label">Fecha:</label>
                            <input type="date" class="form-control" id="sessionDate" required disabled>
                        </div>
                        <div class="mb-3">
                            <label for="sessionStartTime" class="form-label">Hora de Inicio:</label>
                            <input type="time" class="form-control" id="sessionStartTime" required>
                        </div>
                        <div class="mb-3">
                            <label for="sessionEndTime" class="form-label">Hora de Fin:</label>
                            <input type="time" class="form-control" id="sessionEndTime" required>
                        </div>
                        <div class="mb-3">
                            <label for="selectFisiosSesion" class="form-label">Fisioterapeuta:</label>
                            <select class="form-select" id="selectFisiosSesion">
                                </select>
                        </div>
                        <div class="mb-3">
                            <label for="selectedPacienteName" class="form-label">Paciente:</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="selectedPacienteName" readonly placeholder="Ningún paciente seleccionado">
                                    <button class="btn btn-outline-secondary" type="button" id="selectPacienteBtn" data-bs-toggle="modal" data-bs-target="#selectPacienteModalSesion">Seleccionar Paciente</button>
                                    <input type="hidden" id="selectedPacienteId" disabled> </div>
                        </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-primary" id="saveSessionBtn">Guardar Sesión</button>
                        </div>
                    </form>
                </div>
                
            </div>
</div>

<!-- MODAL AGREGAR PACIENTE A SESION -->
<div class="modal fade" id="selectPacienteModalSesion" tabindex="-1" aria-labelledby="selectPacienteModalLabelSesion" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="selectPacienteModalLabelSesion">Seleccionar Paciente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="filtrosPacienteSeleccionContainerSesion">
                    <div class="row mb-3 align-items-end">
                        <div class="col-md-4">
                            <label for="selectDiagnosticosBuscarSeleccionSesion" class="form-label">Filtrar por diagnósticos:</label>
                            <select id="selectDiagnosticosBuscarSeleccionSesion" class="form-select"></select>
                        </div>
                        <div class="col-md-4">
                            <label for="inputBuscarNombreSeleccionSesion" class="form-label">Nombre:</label>
                            <input type="text" id="inputBuscarNombreSeleccionSesion" class="form-control" placeholder="Buscar por nombre">
                        </div>
                        <div class="col-md-4">
                            <label for="inputBuscarCedulaSeleccionSesion" class="form-label">Cédula:</label>
                            <input type="text" id="inputBuscarCedulaSeleccionSesion" class="form-control" placeholder="Buscar por cédula">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="selectActiveSeleccionSesion" class="form-label">Mostrar:</label>
                            <select id="selectActiveSeleccionSesion" class="form-select"></select>
                        </div>
                    </div>
                </div>

                <div id="divTablaPacientesSeleccionSesion" class="table-scroll shadow-sm rounded border">
                    <div id="tableLoadingOverlaySeleccionSesion" class="loading-overlay" style="display: none;">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="mt-2 text-primary">Cargando pacientes...</p>
                    </div>
                    <table class="table table-sm table-hover" id="tablaPacientesSeleccionSesion">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Nombre y Apellido</th>
                                <th scope="col">Cédula</th>
                                <th scope="col">Diagnósticos</th>
                                <th scope="col">Teléfono</th>
                                <th scope="col">Gmail</th>
                                <th scope="col">Activo</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>

                    <div class="d-flex justify-content-between align-items-center p-2 text-muted bg-light border-top">
                        <div class="d-flex align-items-center">
                            Total de pacientes: <strong id="contadorPacientesSeleccionSesion" class="ms-1">0</strong>
                        </div>
                        <nav aria-label="Navegación de pacientes">
                            <ul class="pagination mb-0" id="paginationControlsSeleccionSesion"></ul>
                        </nav>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnSeleccionarPacienteModalSesion" disabled>Agregar Paciente</button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL DE ESTADISTICAS SEISONES FISIOS -->
 <div class="modal fade" id="modalEstadisticasSesiones" tabindex="-1" aria-labelledby="modalEstadisticasSesionesLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalEstadisticasSesionesLabel">Estadísticas de Sesiones</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formFiltroSesiones">
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="selectMesEstadisticas" class="form-label">Mes:</label>
                            <select class="form-select" id="selectMesEstadisticas" required>
                                <option value="" disabled selected>Selecciona un mes</option>
                                <option value="1">Enero</option>
                                <option value="2">Febrero</option>
                                <option value="3">Marzo</option>
                                <option value="4">Abril</option>
                                <option value="5">Mayo</option>
                                <option value="6">Junio</option>
                                <option value="7">Julio</option>
                                <option value="8">Agosto</option>
                                <option value="9">Septiembre</option>
                                <option value="10">Octubre</option>
                                <option value="11">Noviembre</option>
                                <option value="12">Diciembre</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="selectAniosEstadisticas" class="form-label">Año:</label>
                            <select class="form-select" id="selectAniosEstadisticas" required>
                                <option value="" disabled selected>Selecciona un año</option>
                                </select>
                        </div>
                        <div class="col-md-4">
                            <label for="selectFisiosEstadisticas" class="form-label">Fisioterapeuta:</label>
                            <select class="form-select" id="selectFisiosEstadisticas" required>
                                <option value="" disabled selected>Selecciona un fisio</option>
                                </select>
                        </div>
                    </div>
                </form>
                <div class="table-responsive shadow-sm rounded border">
                    <table class="table table-sm table-hover" id="modalTablaSesionesEstadisticas">
                        <thead class="table-light">
                            <tr>
                                <th>Fecha</th>
                                <th>Hora Inicio</th>
                                <th>Hora Fin</th>
                                <th>Fisioterapeuta</th>
                                <th>Paciente</th>
                            </tr>
                        </thead>
                        <tbody id="modalTablaSesionesEstadisticasBody">
                        </tbody>
                    </table>
                    <div class="d-flex justify-content-between align-items-center p-2 text-muted bg-light border-top">
                        <div class="d-flex align-items-center">
                            Total de sesiones: <strong id="contadorSesionesEstadisticas" class="ms-1">0</strong>
                        </div>
                    </div>
                    <div id="noSesionesMensajeEstadisticas" class="p-3 text-center text-muted" style="display: none;">
                        No hay sesiones programadas para los criterios seleccionados.
                    </div>
                </div>    
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" id="btnVerSesionesEstadisticas">Ver sesiones</button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL PARA AGREGAR/ELIMINAR PACIENTES AGREGAR/ELIMINAR FISIOS HORARIO -->
<div class="modal fade" id="agendaDetailModal" tabindex="-1" aria-labelledby="agendaDetailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl"> <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="agendaDetailModalLabel">Detalles del Grupo</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p><strong>Horario:</strong> <span id="modalHorario"></span></p>
                <p><strong>Día:</strong> <span id="modalDia"></span></p>
                <p><strong>Cantidad de Pacientes:</strong> <span id="modalCantidad"></span></p>
                
                <div class="row mt-3">
                    <div class="col-md-6">
                        <h6>Pacientes:</h6>
                        <ul id="modalIntegrantesList" class="list-group">
                            </ul>
                        <p id="noParticipantsMessage" class="text-muted d-none">No hay pacientes en este grupo.</p>
                        
                        <div class="mt-3 d-flex gap-2">
                            <button id="btnAgregarPacienteHorario" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#selectPacienteModal">Agregar Paciente</button>
                            <button id="btnEliminarPacienteHorario" class="btn btn-danger btn-sm" disabled>Eliminar Paciente</button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6>Fisioterapeutas Asignados:</h6>
                        <ul id="modalFisioterapeutasList" class="list-group">
                            </ul>
                        <p id="noFisioterapeutasMessage" class="text-muted d-none">No hay fisioterapeutas asignados a este grupo.</p>

                        <div class="mt-3 d-flex gap-2">
                            <button id="btnAgregarFisioterapeutaHorario" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#modalAgregarFisios">Agregar Fisioterapeuta</button>
                            <button id="btnEliminarFisioterapeutaHorario" class="btn btn-secondary btn-sm" disabled>Eliminar Fisioterapeuta</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="btnEliminarHorario" class="btn btn-outline-danger btn-sm">Eliminar Horario</button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL AGREGAR PACIENTE A GRUPO -->
<div class="modal fade" id="selectPacienteModal" tabindex="-1" aria-labelledby="selectPacienteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="selectPacienteModalLabel">Seleccionar Paciente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="filtrosPacienteSeleccionContainer">
                    <div class="row mb-3 align-items-end">
                        <div class="col-md-4">
                            <label for="selectDiagnosticosBuscarSeleccion" class="form-label">Filtrar por diagnósticos:</label>
                            <select id="selectDiagnosticosBuscarSeleccion" class="form-select"></select>
                        </div>
                        <div class="col-md-4">
                            <label for="inputBuscarNombreSeleccion" class="form-label">Nombre:</label>
                            <input type="text" id="inputBuscarNombreSeleccion" class="form-control" placeholder="Buscar por nombre">
                        </div>
                        <div class="col-md-4">
                            <label for="inputBuscarCedulaSeleccion" class="form-label">Cédula:</label>
                            <input type="text" id="inputBuscarCedulaSeleccion" class="form-control" placeholder="Buscar por cédula">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="selectActiveSeleccion" class="form-label">Mostrar:</label>
                            <select id="selectActiveSeleccion" class="form-select"></select>
                        </div>
                    </div>
                </div>

                <div id="divTablaPacientesSeleccion" class="table-scroll shadow-sm rounded border">
                    <div id="tableLoadingOverlaySeleccion" class="loading-overlay" style="display: none;">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="mt-2 text-primary">Cargando pacientes...</p>
                    </div>
                    <table class="table table-sm table-hover" id="tablaPacientesSeleccion">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Nombre y Apellido</th>
                                <th scope="col">Cédula</th>
                                <th scope="col">Diagnósticos</th>
                                <th scope="col">Teléfono</th>
                                <th scope="col">Gmail</th>
                                <th scope="col">Activo</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>

                    <div class="d-flex justify-content-between align-items-center p-2 text-muted bg-light border-top">
                        <div class="d-flex align-items-center">
                            Total de pacientes: <strong id="contadorPacientesSeleccion" class="ms-1">0</strong>
                        </div>
                        <nav aria-label="Navegación de pacientes">
                            <ul class="pagination mb-0" id="paginationControlsSeleccion"></ul>
                        </nav>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnSeleccionarPacienteModal" disabled>Agregar Paciente</button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL AGREGAR FISIOTERAPEUTA -->
<div class="modal fade" id="modalAgregarFisios" tabindex="-1" aria-labelledby="modalAgregarFisiosLabel">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalAgregarFisiosLabel">Agregar Fisioterapeuta</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formAgregarFisios">
                    <div class="mb-3">
                        <label for="selectFisios" class="form-label">Fisioterapeuta: </label>
                        <select class = "form-control" id="selectFisios"></select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button id="btnAgregarFisios" type="submit" class="btn btn-success" >Agregar Fisioterapeuta</button>
            </div>
        </div>
    </div>
</div>

<!-- DIV PACIENTES -->
<div id="divPaciente" class="container d-none">
    <div id="filtrosPacienteContainer">
        <div class="row mb-3 align-items-end">
            <div class="col-md-4">
                <label for="selectDiagnosticosBuscar" class="form-label">Filtrar por diagnósticos:</label>
                <select id="selectDiagnosticosBuscar" class="form-select"></select>
            </div>
            <div class="col-md-4">
                <label for="inputBuscarNombre" class="form-label">Nombre:</label>
                <input type="text" id="inputBuscarNombre" class="form-control" placeholder="Buscar por nombre">
            </div>
            <div class="col-md-4">
                <label for="inputBuscarCedula" class="form-label">Cédula:</label>
                <input type="text" id="inputBuscarCedula" class="form-control" placeholder="Buscar por cédula">
            </div>
        </div>

    <div class="row mb-3">
        <div class="col-md-4">
            <label for="selectActive" class="form-label">Mostrar:</label>
            <select id="selectActive" class="form-select"></select>
        </div>
        <div class="col-md-8 text-end">
            <button id = "btnAgregarPaciente" data-bs-toggle="modal" 
            data-bs-target="#modalAgregarPaciente" class="btn btn-primary mt-4"
            data-mode="add">Agregar Nuevo Paciente</button>
        </div>
    </div>
    </div>


<div id="divTablaPacientes" class="table-scroll shadow-sm rounded border">
    <div id="tableLoadingOverlay" class="loading-overlay" style="display: none;">
        <img src="/public/apple-touch-icon.png" alt="Cargando..." class="loading-image"> 
        <p class="mt-2 text-primary">Cargando pacientes...</p>
    </div>
        <table class="table table-sm table-hover" id="tablaPacientes">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Nombre y Apellido</th>
                    <th scope="col">Cédula</th>
                    <th scope="col">Diagnósticos</th>
                    <th scope="col">Telefono</th>
                    <th scope="col">Gmail</th>
                    <th scope="col">Activo</th>
                    </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
</div>
<div class="d-flex justify-content-between align-items-center p-2 text-muted bg-light border-top">
            <div class="d-flex align-items-center">
                Total de pacientes: <strong id="contadorPacientes" class="ms-1">0</strong>
            </div>
            <nav aria-label="Navegación de pacientes">
                <ul class="pagination mb-0" id="paginationControls"></ul>
            </nav>
</div>

    <div class="mt-3">
        <button id="btnVerFicha" class="btn btn-info me-2" disabled>Ver Historia Clínica</button>
        <button id="btnModificarDatosPersonales" class="btn btn-warning me-2" data-bs-toggle="modal" 
            data-bs-target="#modalAgregarPaciente" data-mode="edit" disabled>Modificar Datos Personales</button>
        <button id="btnEliminarPaciente" class="btn btn-danger me-2" disabled>Eliminar Paciente</button>
    </div>
</div>

<!-- MODAL AGREGAR PACIENTE -->
<div class="modal fade" id="modalAgregarPaciente" tabindex="-1" aria-labelledby="modalAgregarPacienteLabel">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalAgregarPacienteLabel">Agregar Nuevo Paciente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formAgregarPaciente">
                    <div class="mb-3">
                        <label for="inputAgregarNombreApellido" class="form-label">Nombre y Apellido*</label>
                        <input type="text" class="form-control" id="inputAgregarNombreApellido">
                    </div>
                    <div class="mb-3">
                        <label for="inputAgregarCedula" class="form-label">Cédula</label>
                        <input type="text" class="form-control" id="inputAgregarCedula" placeholder="Ej: 12345678" minlength="8" maxlength="8">
                        <div class="form-text">SIN PUNTOS NI GUIONES</div>
                    </div>
                    <div class="mb-3">
                        <label for="inputAgregarFechaNacimiento" class="form-label">Fecha de Nacimiento</label>
                        <input type="date" class="form-control" id="inputAgregarFechaNacimiento">
                    </div>
                    <div class="mb-3">
                        <label for="inputAgregarTelefono" class="form-label">Telefono*</label>
                        <div class="input-group">
                            <select class="form-select" id="selectCodigoPais" style="max-width: 200px;" required></select>
                            <input type="tel" class="form-control" id="inputAgregarTelefono"
                            pattern="[0-9]{6,12}"
                            placeholder="Ej: 99123456"
                            title="Ingresa solo los dígitos del número de teléfono local (6 a 12 dígitos)" required>
                        </div>
                        <div class="form-text">Ejemplo: +598 99123456</div>
                    </div>
                    <div class="mb-3">
                        <label for="inputAgregarGmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="inputAgregarGmail">
                    </div>
                    <div class="mb-3">
                        <label for="selectAgregarGenero" class="form-label">Género*</label>
                        <select class="form-select" id="selectAgregarGenero" required>
                            <option value="" disabled selected>Selecciona...</option>
                            <option value="M">Masculino</option>
                            <option value="F">Femenino</option>
                            <option value="O">Otro</option>
                        </select>
                    </div>
                    <div class="form-text">Los espacios con * son obligatorios</div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" id="btnGuardarPaciente">Guardar Paciente</button>
            </div>
        </div>
    </div>
</div>

<!-- DIV FICHA MEDICA -->
<div class="container d-none" id="divFichaMedica">
    <h2 class="mb-4">Historia Clínica</h2>
    <div id="tableLoadingOverlayFichaMedica" class="loading-overlay" style="display: none;">
            <img src="/public/apple-touch-icon.png" alt="Cargando..." class="loading-image"> 
        <p class="mt-2 text-primary">Cargando Historia Clínica...</p>
    </div>

    <div class="card mb-4" style="border-color: #8FBC8F;">
        <div class="card-header text-white" style="background-color: #194e30;">
            Información del Paciente
        </div>
        <div class="card-body">
            <p><strong>NUMERO DE PACIENTE:</strong> <span id="fichaId"></span></p>
            <p><strong>NOMBRE:</strong> <span id="fichaNombre"></span></p>
            <p><strong>EDAD:</strong> <span id="fichaEdad"></span></p>
            <p><strong>GÉNERO:</strong> <span id="fichaGenero"></span></p>
            <p><strong>NRO DE TELÉFONO:</strong> <span id="fichaTelefono"></span></p>
            <p><strong>GMAIL:</strong> <span id="fichaGmail"></span></p>
            <p><strong>ACTIVO:</strong> <span id="fichaActivo"></span></p>
            <p><strong>FECHA DE INSCRIPCIÓN:</strong> <span id="fichaFechaCreacion"></span></p>
        </div>
    </div>

    <div class="card">
        <div class="card-header text-white d-flex justify-content-between align-items-center" style="background-color: #194e30;">
            Diagnósticos y Observaciones
            <button class="btn btn-info diagnostico-btn" id="btnAgregarDiagnosticoPaciente" title="Agregar nuevo diagnóstico" data-bs-toggle="modal" data-bs-target="#modalAgregarDiagnosticoPaciente">Agregar diagnostico</button>
        </div>
        <div class="card-body">
            <div id="diagnosticosContainer">    
            </div>
        </div>
    </div>
</div>

<!-- MODAL AGREGAR DIAGNOSTICO A PACIENTE-->
<div class="modal fade" id="modalAgregarDiagnosticoPaciente" tabindex="-1" aria-labelledby="modalAgregarDiagnosticoPacienteLabel">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalAgregarDiagnosticoPacienteLabel">Agregar Nuevo Diagnostico</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formAgregarDiagnosticoPaciente">
                    <div class="mb-3">
                        <label for="selectDiagnosticosPaciente" class="form-label">Diagnostico: </label>
                        <select class = "form-control" id="selectDiagnosticosPaciente"></select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button id="btnAgregarDiagnosticoPaciente2" type="submit" class="btn btn-success me-2" >Agregar diagnostico al paciente</button>
                <button type="submit" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalAgregarDiagnostico" data-mode="add">Crear nuevo diagnostico</button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL AGREGAR DIAGNOSTICO -->
<div class="modal fade" id="modalAgregarDiagnostico" tabindex="-1" aria-labelledby="modalAgregarDiagnosticoLabel">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalAgregarDiagnosticoLabel">Agregar Nuevo Diagnostico</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formAgregarDiagnostico">
                    <div class="mb-3">
                        <label for="inputNombreDiagnostico" class="form-label">Nombre </label>
                        <input type="text" class="form-control" id="inputNombreDiagnostico" required min="2" max="99">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button id="btnGuardarDiagnostico" type="submit" class="btn btn-success">Agregar diagnostico</button>
            </div>
        </div>
    </div>
</div>

<!-- DIV NOMBRE DIAGNOSTICOS -->
<div id="divNombreDiagnostico" class="container d-none mt-4">
    <div id="filtrosDiagnosticoContainer"></div>
    <div id="divTablaNombresDiagnosticos"class="table-scroll shadow-sm rounded border">
        <div id="tableLoadingOverlayDiagnostico" class="loading-overlay" style="display: none;">
            <img src="/public/apple-touch-icon.png" alt="Cargando..." class="loading-image"> 
            <p class="mt-2 text-primary">Cargando diagnósticos...</p>
        </div>
            <table class="table table-striped table-hover caption-top" id="tablaNombresDiagnosticos">
                    <thead class="table-light">
                        <tr>
                            <!-- <th scope="col">#</th> -->
                            <th scope="col">Nombre de los diagnósticos</th>
                        </tr>
                    </thead>
                    <tbody id="tbodyNombresDiagnosticos">
                        <tr>
                            <td colspan="3" class="text-center text-muted">Cargando diagnósticos...</td>
                        </tr>
                    </tbody>
            </table>
        </div>
        <div class="mt-3">
            <button type="submit" class="btn btn-success me-2" data-bs-toggle="modal" 
            data-bs-target="#modalAgregarDiagnostico" data-mode="add"> Agregar Nuevo Diagnóstico </button>
            <button id="btnEliminarNombreDiagnostico" class="btn btn-danger" disabled> Eliminar Diagnóstico Seleccionado </button>
            <button id="btnModificarNombreDiagnostico" class="btn btn-warning me-2" data-bs-toggle="modal" 
            data-bs-target="#modalAgregarDiagnostico" data-mode="edit" disabled>Modificar nombre del diagnostico</button>
        </div>
</div>

<!-- DIV CUOTAS -->
<div id="divCuotas" class="container d-none mt-4">
    <div id="filtrosCuotasContainer">
        <div class="row mb-3 align-items-end">
            <div class="col-md-4">
                <label for="filtroPacienteNombreCuota" class="form-label">Nombre:</label>
                <input type="text" class="form-control" id="filtroPacienteNombreCuota" placeholder="Buscar por Nombre">
            </div>
            <div class="col-md-4">
                <label for="filtroPacienteCedulaCuota" class="form-label">Cédula:</label>
                <input type="text" class="form-control" id="filtroPacienteCedulaCuota" placeholder="Buscar por Cédula">
            </div>
            <div class="col-md-4">
                <label for="filtroEstadoCuota" class="form-label">Estado:</label>
                <select class="form-select" id="filtroEstadoCuota">
                </select>
            </div>
        </div>

        <div class="row mb-3 align-items-end">
            <div class="col-md-4">
                <label for="filtroMesCuota" class="form-label">Mes:</label>
                <select class="form-select" id="filtroMesCuota">
                    <option value="">Todos</option>
                    <option value="1">Enero</option>
                    <option value="2">Febrero</option>
                    <option value="3">Marzo</option>
                    <option value="4">Abril</option>
                    <option value="5">Mayo</option>
                    <option value="6">Junio</option>
                    <option value="7">Julio</option>
                    <option value="8">Agosto</option>
                    <option value="9">Septiembre</option>
                    <option value="10">Octubre</option>
                    <option value="11">Noviembre</option>
                    <option value="12">Diciembre</option>
                </select>
            </div>
            <div class="col-md-4">
                <label for="selectAnioCuotasFiltro" class="form-label">Año:</label>
                <select class="form-select" id="selectAnioCuotasFiltro"></select>
            </div>
            <div class="col-md-4 text-end">
                <button id="btnRegistrarNuevaCuota" class="btn btn-success mt-4" data-bs-toggle="modal" data-bs-target="#modalRegistrarCuota">
                    Agregar cuota manualmente
                </button> 
            </div>
        </div>
    </div>

    <div id="divTablaCuotas" class="table-scroll shadow-sm rounded border mt-4">
        <div id="tableLoadingOverlayCuotas" class="loading-overlay" style="display: none;">
            <img src="/public/apple-touch-icon.png" alt="Cargando..." class="loading-image"> 
            <p class="mt-2 text-primary">Cargando cuotas...</p>
        </div>

        <table class="table table-sm table-hover" id="tablaCuotas">
            <thead>
                <tr>
                    <th scope="col">Nombre</th>
                    <th scope="col">Cédula</th>
                    <th scope="col">Período</th>
                    <th scope="col">Monto</th>
                    <th scope="col">Fecha de Pago</th>
                    <!-- <th scope="col">Fecha de Baja</th> -->
                    <th scope="col">Estado</th>
                </tr>
            </thead>
            <tbody id="tbodyCuotas">
            </tbody>
        </table>
    </div>
    <div class="d-flex justify-content-between align-items-center p-2 text-muted bg-light border-top">
            <div class="d-flex align-items-center">
                Total de cuotas: <strong id="contadorCuotas" class="ms-1">0</strong>
            </div>            
            <nav aria-label="Navegación de cuotas">
                <ul class="pagination mb-0" id="paginationControlsCuotas"></ul>
            </nav>
        </div>

    <div class="mt-3 d-flex">
        <button id="btnRegistrarPagoCuota" class="btn btn-success me-2" data-bs-toggle="modal" data-bs-target="#modalRegistrarPagoCuota" disabled>Pagar/Modificar Cuota</button>
        <button id="btnDarDeBajaCuota" class="btn btn-danger me-2" disabled>Eliminar</button>
        <button id="btnGenerarBalanceCuota" class="btn btn-info ms-auto" data-bs-toggle="modal" data-bs-target="#modalGenerarBalance">Generar Balance</button>
    </div>
</div>

<!-- MODAL GENERAR BALANCE -->
<div class="modal fade" id="modalGenerarBalance" tabindex="-1" aria-labelledby="modalGenerarBalanceLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div id="loadingOverlayBalance" class="loading-overlay" style="display: none;">
        <img src="/public/apple-touch-icon.png" alt="Cargando..." class="loading-image"> 
        <p class="mt-2 text-primary">Generando balance...</p>
    </div>
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalGenerarBalanceLabel">Generar Balance</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      
      <div class="modal-body">
        <form id="formGenerarBalance">
          <!-- Desde -->
          <div class="mb-3">
            <label class="form-label">Desde (Incluido):</label>
            <div class="d-flex gap-2">
              <select id="selectMesDesdeBalance" class="form-select">
                <option value="1">Enero</option>
                <option value="2">Febrero</option>
                <option value="3">Marzo</option>
                <option value="4">Abril</option>
                <option value="5">Mayo</option>
                <option value="6">Junio</option>
                <option value="7">Julio</option>
                <option value="8">Agosto</option>
                <option value="9">Septiembre</option>
                <option value="10">Octubre</option>
                <option value="11">Noviembre</option>
                <option value="12">Diciembre</option>
              </select>
              <select id="selectAnioDesdeBalance" class="form-select"></select>
            </div>
          </div>

          <!-- Hasta -->
          <div class="mb-3">
            <label class="form-label">Hasta (Incluido):</label>
            <div class="d-flex gap-2">
              <select id="selectMesHastaBalance" class="form-select">
                <option value="1">Enero</option>
                <option value="2">Febrero</option>
                <option value="3">Marzo</option>
                <option value="4">Abril</option>
                <option value="5">Mayo</option>
                <option value="6">Junio</option>
                <option value="7">Julio</option>
                <option value="8">Agosto</option>
                <option value="9">Septiembre</option>
                <option value="10">Octubre</option>
                <option value="11">Noviembre</option>
                <option value="12">Diciembre</option>
              </select>
              <select id="selectAnioHastaBalance" class="form-select"></select>
            </div>
          </div>

          <h6 class="mt-4">Ingresos por pacientes que vienen:</h6>
          
          <!-- 1 vez -->
          <div class="row align-items-center mb-2">
            <div class="col-5">
              <label class="mb-0">1 vez a la semana</label>
            </div>
            <div class="col-4">
              <input type="text" id="ingresos1xSemana" class="form-control" disabled>
            </div>
            <div class="col-3 d-flex align-items-center">
              <label class="mb-0 me-2 small text-muted">Cantidad:</label>
              <input type="text" id="cant1xSemana" class="form-control form-control-sm" disabled style="width:72px;">
            </div>
          </div>

          <!-- 2 veces -->
          <div class="row align-items-center mb-2">
            <div class="col-5">
              <label class="mb-0">2 veces a la semana</label>
            </div>
            <div class="col-4">
              <input type="text" id="ingresos2xSemana" class="form-control" disabled>
            </div>
            <div class="col-3 d-flex align-items-center">
              <label class="mb-0 me-2 small text-muted">Cantidad:</label>
              <input type="text" id="cant2xSemana" class="form-control form-control-sm" disabled style="width:72px;">
            </div>
          </div>

          <!-- 3 veces -->
          <div class="row align-items-center mb-2">
            <div class="col-5">
              <label class="mb-0">3 veces a la semana</label>
            </div>
            <div class="col-4">
              <input type="text" id="ingresos3xSemana" class="form-control" disabled>
            </div>
            <div class="col-3 d-flex align-items-center">
              <label class="mb-0 me-2 small text-muted">Cantidad:</label>
              <input type="text" id="cant3xSemana" class="form-control form-control-sm" disabled style="width:72px;">
            </div>
          </div>

          <!-- 4 veces -->
          <div class="row align-items-center mb-2">
            <div class="col-5">
              <label class="mb-0">4 veces a la semana</label>
            </div>
            <div class="col-4">
              <input type="text" id="ingresos4xSemana" class="form-control" disabled>
            </div>
            <div class="col-3 d-flex align-items-center">
              <label class="mb-0 me-2 small text-muted">Cantidad:</label>
              <input type="text" id="cant4xSemana" class="form-control form-control-sm" disabled style="width:72px;">
            </div>
          </div>

          <!-- 5 veces -->
          <div class="row align-items-center mb-2">
            <div class="col-5">
              <label class="mb-0">5 veces a la semana</label>
            </div>
            <div class="col-4">
              <input type="text" id="ingresos5xSemana" class="form-control" disabled>
            </div>
            <div class="col-3 d-flex align-items-center">
              <label class="mb-0 me-2 small text-muted">Cantidad:</label>
              <input type="text" id="cant5xSemana" class="form-control form-control-sm" disabled style="width:72px;">
            </div>
          </div>

          <!-- Otro -->
          <div class="row align-items-center mb-2">
            <div class="col-5">
              <label class="mb-0">Otro</label>
            </div>
            <div class="col-4">
              <input type="text" id="ingresosOtros" class="form-control" disabled>
            </div>
            <div class="col-3 d-flex align-items-center">
              <label class="mb-0 me-2 small text-muted">Cantidad:</label>
              <input type="text" id="cantOtros" class="form-control form-control-sm" disabled style="width:72px;">
            </div>
          </div>
          
          <div class="mb-3 row align-items-center">
            <div class="col-5">
              <label class="me-2 fw-bold mb-0">Ingresos totales:</label>
            </div>
            <div class="col-4">
              <input type="text" id="ingresosTotales" class="form-control" disabled>
            </div>
            <div class="col-3 d-flex align-items-center">
              <label class="mb-0 me-2 small text-muted">Total:</label>
              <input type="text" id="cantTotal" class="form-control form-control-sm" disabled style="width:72px;">
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="submit" class="btn btn-primary" form="formGenerarBalance" id="btnGenerarBalance">Generar Balance</button>
      </div>

    </div>
  </div>
</div>


<!-- MODAL REGISTRAR CUOTA MANUALMENTE -->
<div class="modal fade" id="modalRegistrarCuota" tabindex="-1" aria-labelledby="modalRegistrarCuotaLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalRegistrarCuotaLabel">Agregar Cuota</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="close"></button>
            </div>
            <div class="modal-body">
                <form id="formNuevaCuota">
                    <div class="mb-3">
                        <label for="selectedPacienteNameCuota" class="form-label">Paciente</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="selectedPacienteNameCuota" readonly placeholder="Ningún paciente seleccionado">
                                <button class="btn btn-outline-secondary" type="button" id="selectPacienteBtnCuota" data-bs-toggle="modal" data-bs-target="#selectPacienteCuotaModal">Seleccionar Paciente</button>
                                <input type="hidden" id="selectedPacienteIdCuota" disabled>
                            </div>
                    </div>
                    <div class = "mb-3">
                        <label for="inputMontoNuevaCuota" class="form-label">Monto</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="inputMontoNuevaCuota" value=0>
                                <div class="form-text">Al seleccionar un paciente, el monto se asignará según la cantidad de grupos en los que el paciente este inscripto. Este monto se puede modificar manualmente.</div>
                            </div>
                    </div>
                    <div class="mb-3">
                        <label for="selectMesNuevaCuota" class="form-label">Mes</label>
                        <select class="form-select" id="selectMesNuevaCuota" required>
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label for="selectAnioCuotasRegistro" class="form-label">Año</label>
                        <select class="form-select" id="selectAnioCuotasRegistro"></select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" form="formNuevaCuota" id="btnGuardarCuota">Agregar Cuota</button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL AGREGAR PACIENTE A CUOTA -->
<div class="modal fade" id="selectPacienteCuotaModal" tabindex="-1" aria-labelledby="selectPacienteCuotaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="selectPacienteCuotaModalLabel">Seleccionar Paciente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="filtrosPacienteCuotaContainer">
                    <div class="row mb-3 align-items-end">
                        <div class="col-md-4">
                            <label for="selectDiagnosticosBuscarSeleccionCuota" class="form-label">Filtrar por diagnósticos:</label>
                            <select id="selectDiagnosticosBuscarSeleccionCuota" class="form-select"></select>
                        </div>
                        <div class="col-md-4">
                            <label for="inputBuscarNombreSeleccionCuota" class="form-label">Nombre:</label>
                            <input type="text" id="inputBuscarNombreSeleccionCuota" class="form-control" placeholder="Buscar por nombre">
                        </div>
                        <div class="col-md-4">
                            <label for="inputBuscarCedulaSeleccionCuota" class="form-label">Cédula:</label>
                            <input type="text" id="inputBuscarCedulaSeleccionCuota" class="form-control" placeholder="Buscar por cédula">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="selectActiveSeleccionCuota" class="form-label">Mostrar:</label>
                            <select id="selectActiveSeleccionCuota" class="form-select"></select>
                        </div>
                    </div>
                </div>

                <div id="divTablaPacientesCuota" class="table-scroll shadow-sm rounded border">
                    <div id="tableLoadingOverlaySeleccionCuota" class="loading-overlay" style="display: none;">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="mt-2 text-primary">Cargando pacientes...</p>
                    </div>
                    <table class="table table-sm table-hover" id="tablaPacientesSeleccionCuota">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Nombre y Apellido</th>
                                <th scope="col">Cédula</th>
                                <th scope="col">Diagnósticos</th>
                                <th scope="col">Teléfono</th>
                                <th scope="col">Gmail</th>
                                <th scope="col">Activo</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>

                    <div class="d-flex justify-content-between align-items-center p-2 text-muted bg-light border-top">
                        <div class="d-flex align-items-center">
                            Total de pacientes: <strong id="contadorPacientesSeleccionCuota" class="ms-1">0</strong>
                        </div>
                        <nav aria-label="Navegación de pacientes">
                            <ul class="pagination mb-0" id="paginationControlsSeleccionCuota"></ul>
                        </nav>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnSeleccionarPacienteCuotaModal" disabled>Agregar Paciente</button>
            </div>
        </div>
    </div>
</div>


<!-- MODAL REGISTRAR PAGO -->
<div class="modal fade" id="modalRegistrarPagoCuota" tabindex="-1" aria-labelledby="modalRegistrarPagoCuotaLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalRegistrarPagoCuotaLabel">Registrar Pago de Cuota</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formRegistrarPagoCuota">
                    <div class="mb-3">
                        <label for="pagoCuotaPacienteNombre" class="form-label">Paciente</label>
                        <input type="text" class="form-control" id="pagoCuotaPacienteNombre" disabled required>
                        <input type="hidden" id="pagoCuotaPacienteId" disabled>
                    </div>
                    <div class="mb-3">
                        <label for="pagoCuotaPeriodo" class="form-label">Cuota de</label>
                        <input type="text" class="form-control" id="pagoCuotaPeriodo" disabled required>
                    </div>
                    <div class="mb-3">
                        <label for="pagoCuotaMonto" class="form-label">Monto</label>
                        <input type="number" class="form-control" id="pagoCuotaMonto" required>
                    </div>
                    <div class="mb-3">
                        <label for="pagoDescuentoCuota" class="form-label">Descuento (EN %)</label>
                        <input type="number" class="form-control" id="pagoDescuentoCuota" required>
                    </div>
                    <div class="mb-3 d-none">
                        <label for="pagoDescuentoMontoCuota" class="form-label">Monto con descuento</label>
                        <input type="number" class="form-control" id="pagoDescuentoMontoCuota" required disabled>
                    </div>

                    <div class="mb-3">
                        <label for="inputDescripcionPagoCuota" class="form-label">Descripción</label>
                        <textarea class="form-control" id="inputDescripcionPagoCuota" rows="3" maxlength="500"></textarea>
                        <div class="form-text">Máximo 500 caracteres.</div>
                    </div>
                    <div class="mb-3">
                        <label for="inputFechaPagoCuota" class="form-label">Fecha de pago</label>
                        <input type="date" class="form-control" id="inputFechaPagoCuota">
                        <div class="form-text">Si no registra fecha de pago es porque no pagó.</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="selectMetodoPagoCuota" class="form-label">Método de Pago</label>
                        <select class="form-select" id="selectMetodoPagoCuota" required>
                            <option value="NoEspecificado" disabled selected>Seleccione un método</option>
                            <option value="Efectivo">Efectivo</option>
                            <option value="Debito">Tarjeta de débito</option>
                            <option value="Credito">Tarjeta de crédito</option>
                            <option value="Deposito">Depósito</option>
                            <option value="Transferencia">Transferencia</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" form="formRegistrarPagoCuota" id="btnConfirmarPago">Confirmar Pago</button>
            </div>
        </div>
    </div>
</div>

<!-- <div class="modal fade" id="modalEditarCuota" tabindex="-1" aria-labelledby="modalEditarCuotaLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalEditarCuotaLabel">Editar Cuota</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formEditarCuota">
                    <p>Paciente: <strong id="editarCuotaPacienteNombre"></strong></p>
                    <p>Cuota de: <strong id="editarCuotaPeriodo"></strong></p>
                    <div class="mb-3">
                        <label for="inputMontoEditarCuota" class="form-label">Monto</label>
                        <input type="number" class="form-control" id="inputMontoEditarCuota" step="0.01" required>
                    </div>
                    <div class="mb-3">
                        <label for="inputDescripcionEditarCuota" class="form-label">Descripción</label>
                        <textarea class="form-control" id="inputDescripcionEditarCuota" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="submit" class="btn btn-primary" form="formEditarCuota">Guardar Cambios</button>
            </div>
        </div>
    </div>
</div> -->






</div>






</body>
</html>
